{"Timestamp":"2025-08-01T08:11:15Z","RemoteHost":"FZ551FTTA42970","Status":"Error","Message":"Connecting to FZ551FTTA42970...\r\r\rStarting PSEXESVC service on FZ551FTTA42970...\r\r\rCopying authentication key to FZ551FTTA42970...\r\r\rConnecting with PsExec service on FZ551FTTA42970...\r\r\rStarting powershell.exe on FZ551FTTA42970...\r\r\r\r\n        try {\r\n            $ErrorActionPreference = Stop\r\n            Set-ExecutionPolicy -Scope Process -ExecutionPolicy RemoteSigned -Force\r\n            if (-not (Get-Module -Name PowerShellGet -ListAvailable)) {\r\n                try {\r\n                    Install-PackageProvider -Name NuGet -Force -Scope CurrentUser -ErrorAction \r\nStop\r\n                    Install-Module -Name PowerShellGet -Force -Scope CurrentUser -Repository \r\nPSGallery -ErrorAction Stop\r\n                } catch {\r\n                    throw Failed to install PowerShellGet: $($_.Exception.Message)\r\n                }\r\n            }\r\n            Import-Module PowerShellGet -ErrorAction Stop\r\n            if (-not (Get-Module -Name PSWindowsUpdate -ListAvailable)) {\r\n                try {\r\n                    Install-Module -Name PSWindowsUpdate -Force -Scope CurrentUser -Repository \r\nPSGallery -ErrorAction Stop\r\n                } catch {\r\n                    throw Failed to install PSWindowsUpdate: $($_.Exception.Message)\r\n                }\r\n            }\r\n            Import-Module PSWindowsUpdate -ErrorAction Stop\r\n            try {\r\n                Install-WindowsUpdate -MicrosoftUpdate -AcceptAll -IgnoreReboot -ErrorAction Stop\r\n            } catch {\r\n                throw Windows Update failed: $($_.Exception.Message)\r\n            }\r\n            if (-not (Get-Command winget -ErrorAction SilentlyContinue)) {\r\n                $wingetInstallerUrl = \u0027https://github.com/microsoft/winget-cli/releases/latest/dow\r\nnload/Microsoft.DesktopAppInstaller_8wekyb3d8bbwe.msixbundle\u0027\r\n                $wingetInstallerPath = Join-Path -Path $env:TEMP -ChildPath \u0027winget.msixbundle\u0027\r\n                try {\r\n                    Invoke-WebRequest -Uri $wingetInstallerUrl -OutFile $wingetInstallerPath \r\n-UseBasicParsing -ErrorAction Stop\r\n                } catch {\r\n                    throw Failed to download winget: $($_.Exception.Message)\r\n                }\r\n                if ([string]::IsNullOrEmpty($using:WingetExpectedHash) -eq $false) {\r\n                    $computedHash = (Get-FileHash -Path $wingetInstallerPath -Algorithm \r\nSHA256).Hash\r\n                    if ($computedHash -ne $using:WingetExpectedHash) {\r\n                        throw Winget installer hash mismatch. Expected \r\n$($using:WingetExpectedHash), got $computedHash\r\n                    }\r\n                }\r\n                try {\r\n                    Add-AppxPackage -Path $wingetInstallerPath -ErrorAction Stop\r\n                } catch {\r\n                    throw Failed to install winget: $($_.Exception.Message)\r\n                }\r\n            }\r\n            try {\r\n                winget upgrade --all --include-unknown --silent --accept-package-agreements \r\n--accept-source-agreements --force | Out-Null\r\n            } catch {\r\n                throw winget upgrade failed: $($_.Exception.Message)\r\n            }\r\n            try {\r\n                Get-CimInstance -Namespace \u0027Root\\\\cimv2\\\\mdm\\\\dmmap\u0027 -ClassName \r\n\u0027MDM_EnterpriseModernAppManagement_AppManagement01\u0027 | Invoke-CimMethod -MethodName \r\nUpdateScanMethod | Out-Null\r\n            } catch {\r\n                Write-Warning Failed to trigger MDM update scan: $($_.Exception.Message)\r\n            }\r\n            $needsReboot = $false\r\n            try {\r\n                if (Get-WURebootStatus -Silent) { $needsReboot = $true }\r\n            } catch {\r\n                Write-Warning Failed to check reboot status: $($_.Exception.Message)\r\n            }\r\n            if ($needsReboot -and $using:AutoReboot) {\r\n                Restart-Computer -Force\r\npowershell.exe exited on FZ551FTTA42970 with error code 1."}
